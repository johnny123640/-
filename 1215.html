<html>
    <head>
        <title>1215-宇宙射擊遊戲</title>
        <style>
            #spaces {
                width:800px;
                height: 800px;
                background:url("pic/bg_stars.jpg");
                animation: bg_move 2s linear infinite;
            }
            @keyframes bg_move {
                0%{background-position-y: 0px;}
                100% {background-position-y: 216px;}
            }
            #ship {
                width: 40px;
                height: 60px;
                background: url("pic/ship.png");
                background-size: 40px 60px;
                position: absolute;
                
            }
            .ufo {
                width: 60px;
                height: 40px;
                background: url("pic/ufo.png");
                background-size: 60px 40px;
                position: absolute;
            }
            .bullet{
                width: 40px;
                height: 6px;
                background-color: red;
                position: absolute;
            }

        </style>
        <script>

            
            function game_init() {
                dir={"ArrowLeft":0,"ArrowRight":0,"ArrowUp":0,"ArrowDown":0}
                spaces={w:800,h:800}; //定義一個物件
                ship=document.getElementById("ship");
                ship.w=40;
                ship.h=60;
                ship.posX=(spaces.w-ship.w)/2
                ship.posY=spaces.h-ship.h;

                ship.style.left=ship.posX+"px";
                ship.style.top=ship.posY+"px";
                ship.move=setInterval(ship_move,5)

                game_t1=setInterval(ufo_create,1000);
            }
            function mykeydown() {
                event.preventDefault();
                if(event.key == " ") {
                    shoot();
                } else if(Object.keys(dir).includes(event.key)) {
                    
                
                dir[event.key]=1;
                }
            }
            function mykeyup() {
                event.preventDefault();
                dir[event.key]=0;
                }
                function getRand(min,max) {
                    return Math.floor(Math.random() * (max-min+1)) + min;
                }
            function ship_move() {
                if(ship.posX > 0 && dir["ArrowLeft"]) {
                    ship.posX--;
                } else if(ship.posX + ship.w && dir["ArrowRight"]) {
                    ship.posX++;
                }
                ship.style.left=ship.posX+"px";
                }
            function ufo_move(ufo) {
                if(ufo.posY + ufo.h > spaces.h) {
                    clearInterval(ufo.move);
                    ufo.remove();
                    return;
                } 
                    ufo.posY++;
                    ufo.posX += getRand(-2,2);
                    if(ufo.posX < 0) {
                        ufo.posY=0;
                    } else if(ufo.posX+ufo.w > spaces.w) {
                        ufo.posX = spaces.w - ufo.w;
                    }
                    u.style.left=ufo.posX+"px";
                    u.style.top=ufo.posY+"px";
                
                }
            function ufo_create() {
                    var u=document.createElement("img");
                    u.src="pic/ufo.png";
                    u.className="ufo";
                    u.w=60;
                    u.h=40;
                    u.posX=getRand(0,spaces.w - u.w);
                    u.posY=getRand(0,10);
                    document.getElementById("spaces").appendChild(u);
                    u.style.left=u.posX+"px";
                    u.style.top=u.posY+"px";
                    u.move=setInterval(ufo_move,20,u);
                }
                function bullet_move(bt) {
                    if(bt.posY < 0) {
                        clearInterval(bt.move);
                        bt.remove();
                    }

                }
                function shoot() {
                    var b=document.createElement("div");
                    b.className="bullet";
                    b.w=4;
                    b.h=6;
                    b.posX=ship.posX+(ship.w-b.w)/2;
                    b.posY=ship.posY-b.h;
                    document.getElementById("spaces").appendChild(b);
                    b.style.left=b.posX+"px";
                    b.style.top=b.posY+"px";
                    b.move=setInterval(bullet_move,10,b);
                }


        </script>
    </head>
    <body onload="game_init()" onkeydown="mykeydown()" onkeyup="mykeyup()">
        <div id="spaces">
            <div id="ship"></div>
            <!--img src="pic/ship.png" width="40px"-->
            <div class="bullet"></div>


        </div>



    </body>
</html>